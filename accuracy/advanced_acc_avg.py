# 计算每个科、属的平均准确率（期望）
import os
import re
import numpy as np
import pandas as pd

name_list = ['10Demirastrites triangulatus', '10Dicellograptus tumidus', '10Dicellograptus turgidus',
             '10Paraorthograptus pacificus', '10Spirograptus turriculatus', '11Appendispinograptus venustus',
             '11Nicholsonograptus fasciculatus', '11Nicholsonograptus praelongus', '11Paraorthograptus longispinus',
             '12Cryptograptus tricornis (Juvenile)', '12Phyllograptus anna', '12Rastrites guizhouensis',
             '12Tangyagraptus typicus', '12Yinograptus grandis', '13Coronograptus cyphus', '13Cystograptus vesiculosus',
             '13Normalograptus extraordinarius', '13Normalograptus persculptus', '13Parakidograptus acuminatus',
             '14Diceratograptus mirus', '14Lituigraptus convolutus', '14Paraplegmatograptus connectus',
             '14Pararetiograptus regularis', '1Dicellograptus bispiralis', '1Dicellograptus caduceus',
             '1Dicellograptus divaricatus salopiensis', '1Dicellograptus smithi', '1Dicellograptus undatus',
             '1Dicranograptus irregularis', '1Dicranograptus sinensis', '1Didymograptus jiangxiensis',
             '1Didymograptus latus tholiformis', '1Didymograptus miserabilis', '2Amplexograptus acusiformis',
             '2Amplexograptus fusiformis', '2Cryptograptus arcticus sinensis', '2Cryptograptus gracilicornis',
             '2Dicellograptus divaricatus', '2Dicranograptus nicholsoni parvangulus', '2Dicranograptus ramosus',
             '2Didymograptus euodus', '2Didymograptus linearis longus', '2Didymograptus saerganensis',
             '3Climacograptus pauperatus', '3Cryptograptus arcticus', '3Cryptograptus marcidus',
             '3Cryptograptus tricornis', '3Glossograptus briaros', '3Glossograptus robustus',
             '3Glyptograptus plurithecatus wuningensis', '3Glyptograptus teretiusculus siccatus',
             '3Pseudoclimacograptus parvus jiangxiensis', '3Pseudoclimacograptus wannanensis',
             '4Diplograptus proelongatus', '4Glyptograptus teretiusculus', '4Jiangxigraptus inculus',
             '4Jishougraptus mui', '4Leptograptus flaccidus trentonensis', '4Monoclimacis neimengolensis',
             '4Pseudoclimacograptus angulatus', '4Pseudoclimacograptus longus', '4Pseudoclimacograptus modestus',
             '4Pseudoclimacograptus parvus', '5Amplexograptus disjunctus yangtzensis', '5Amplexograptus suni',
             '5Climacograptus miserabilis', '5Climacograptus supernus', '5Dicellograptus ornatus',
             '5Diplograptus modestus', '5Glyptograptus incertus', '5Petalolithus elongatus', '5Petalolithus folium',
             '5Streptograptus runcinatus', '6Dicellograptus szechuanensis', '6Diplograptus bohemicus',
             '6Glyptograptus austrodentatus', '6Glyptograptus gracilis', '6Glyptograptus lungmaensis',
             '6Glyptograptus tamariscus', '6Glyptograptus tamariscus linealis', '6Glyptograptus tamariscus magnus',
             '6Reteograptus uniformis', '6Retiolites geinitzianus', '7Amplexograptus orientalis',
             '7Climacograptus angustatus', '7Climacograptus leptothecalis', '7Climacograptus minutus',
             '7Climacograptus normalis', '7Climacograptus tianbaensis', '7Colonograptus praedeubeli',
             '7Diplograptus angustidens', '7Diplograptus diminutus', '7Rectograptus pauperatus',
             '8Amplexograptus confertus', '8Climacograptus angustus', '8Climacograptus textilis yichangensis',
             '8Colonograptus deubeli', '8Dicellograptus cf. complanatus', '8Diplograptus concinnus',
             '8Pristiograptus variabilis', '8Pseudoclimacograptus demittolabiosus', '8Pseudoclimacograptus formosus',
             '8Rectograptus abbreviatus', '9Akidograptus ascensus', '9Amplexograptus cf. maxwelli',
             '9Cardiograptus amplus', '9Climacograptus bellulus', '9Climacograptus hastatus', '9Glyptograptus dentatus',
             '9Glyptograptus elegans', '9Glyptograptus elegantulus', '9Orthograptus calcaratus',
             '9Trigonograptus ensiformis']
# 去掉开头的批次号
for index, name in enumerate(name_list):
    if re.match(r'^\d{2}', name):
        name_list[index] = name[2:]
    elif re.match(r'^\d', name):
        name_list[index] = name[1:]
# 解决编码问题
name_list = [name[:].replace(u'\xa0', u' ') for name in name_list]
# pandas读取文件
file_path = os.path.abspath(r'D:\TJU\GBDB\set113\标注属种信息汇总_1125.xlsx')
df = pd.read_excel(file_path, sheet_name=0, header=1, encoding='utf-8')
name_dict = {name: {"phylum": "", "class": "", "order": "", "family": ""} for name in name_list}
# 遍历dataframe每行
for index, row in df.iterrows():
    english_name = row["english_name"].strip().replace(u'\xa0', u' ')
    pattern = re.compile(r'[a-zA-Z]+', re.S)
    phylum_name = re.search(pattern, row["phylum"].strip()).group()
    class_name = re.search(pattern, row["class"].strip()).group()
    order_name = re.search(pattern, row["order"].strip()).group()
    family_name = re.search(pattern, row["family"].strip()).group()
    # 判断类名列表中是否存在
    assert english_name in name_dict, print('种名列表中不存在: ', english_name)
    # 更新字典，记录每个属种的门、纲、目、科名
    name_dict[english_name]["phylum"] = phylum_name
    name_dict[english_name]["class"] = class_name
    name_dict[english_name]["order"] = order_name
    name_dict[english_name]["family"] = family_name
print(name_dict)
print(len(name_dict))

nclasses = 113
test_results = \
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 26, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 36, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 88, 88, 69, 69, 69, 69, 98, 69, 3, 3, 105, 3, 3, 3, 8, 8, 8, 8, 8, 8, 8, 8, 3, 3, 3, 3, 3, 8, 8, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 71, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 63, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 7, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 6, 6, 6, 7, 6, 7, 6, 7, 6, 7, 6, 6, 14, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 6, 7, 7, 6, 7, 7, 6, 6, 7, 6, 6, 7, 7, 6, 6, 7, 7, 7, 7, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 3, 8, 8, 3, 3, 8, 3, 8, 3, 8, 8, 3, 8, 8, 3, 3, 3, 8, 3, 3, 8, 8, 8, 8, 8, 3, 3, 3, 3, 9, 9, 9, 46, 9, 46, 46, 46, 46, 46, 9, 46, 9, 9, 10, 10, 10, 52, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 0, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 8, 13, 8, 8, 8, 8, 8, 8, 8, 8, 71, 13, 46, 13, 46, 13, 46, 13, 46, 46, 46, 46, 46, 83, 62, 86, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 96, 89, 96, 96, 96, 96, 14, 96, 96, 96, 14, 14, 40, 14, 14, 14, 0, 14, 14, 14, 40, 14, 14, 14, 40, 14, 40, 14, 40, 14, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 102, 15, 15, 15, 102, 15, 22, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 22, 15, 15, 16, 83, 83, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 63, 17, 17, 17, 17, 17, 17, 103, 103, 56, 108, 56, 108, 108, 18, 108, 108, 108, 103, 108, 108, 56, 108, 108, 44, 56, 108, 103, 109, 45, 45, 103, 45, 103, 45, 103, 103, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 32, 23, 32, 23, 23, 23, 23, 23, 47, 23, 24, 67, 24, 67, 24, 25, 24, 67, 24, 25, 24, 67, 24, 24, 24, 24, 24, 24, 25, 24, 24, 24, 24, 24, 25, 24, 24, 56, 24, 24, 24, 24, 24, 24, 12, 12, 12, 12, 25, 25, 25, 25, 25, 25, 24, 24, 24, 25, 25, 24, 24, 24, 25, 25, 25, 25, 29, 25, 25, 25, 25, 25, 29, 25, 27, 27, 27, 25, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 25, 25, 27, 27, 27, 27, 27, 25, 27, 25, 27, 27, 27, 27, 27, 27, 23, 27, 27, 27, 57, 25, 57, 25, 25, 29, 29, 29, 35, 29, 28, 29, 35, 67, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 30, 26, 24, 24, 24, 30, 30, 24, 55, 97, 30, 30, 30, 30, 30, 29, 30, 32, 26, 67, 67, 43, 43, 43, 33, 33, 33, 33, 33, 33, 50, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 52, 34, 34, 34, 34, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 44, 44, 36, 36, 44, 36, 36, 36, 36, 44, 36, 112, 112, 33, 52, 33, 33, 33, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 55, 55, 55, 55, 55, 39, 39, 38, 39, 39, 55, 38, 38, 39, 39, 55, 38, 38, 38, 38, 39, 38, 38, 39, 39, 39, 38, 38, 39, 39, 37, 39, 39, 39, 39, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 48, 40, 40, 40, 40, 31, 42, 77, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 0, 48, 40, 99, 40, 90, 40, 29, 55, 37, 55, 41, 42, 38, 38, 38, 32, 32, 38, 38, 42, 40, 42, 42, 42, 42, 40, 42, 42, 42, 40, 42, 42, 40, 42, 42, 42, 42, 42, 42, 40, 42, 42, 42, 43, 60, 65, 43, 65, 65, 43, 65, 44, 43, 43, 44, 46, 44, 55, 44, 44, 44, 43, 44, 65, 43, 65, 51, 65, 65, 65, 65, 84, 46, 44, 46, 44, 57, 44, 44, 44, 44, 44, 35, 44, 44, 44, 44, 45, 45, 45, 53, 45, 45, 53, 45, 45, 38, 45, 45, 45, 45, 45, 45, 45, 45, 45, 44, 44, 46, 44, 46, 72, 44, 44, 44, 72, 46, 46, 44, 44, 44, 44, 44, 47, 47, 49, 47, 47, 49, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 52, 49, 49, 49, 49, 49, 49, 49, 49, 49, 112, 43, 43, 43, 43, 44, 43, 43, 43, 112, 112, 44, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 35, 43, 35, 51, 51, 51, 33, 36, 51, 85, 85, 62, 36, 33, 33, 50, 51, 50, 50, 33, 33, 33, 53, 52, 54, 52, 62, 54, 54, 79, 52, 52, 79, 52, 52, 79, 62, 52, 52, 52, 52, 62, 62, 52, 79, 52, 40, 79, 52, 52, 79, 52, 52, 93, 52, 79, 52, 52, 79, 52, 52, 79, 52, 52, 52, 62, 52, 52, 52, 52, 52, 79, 52, 79, 52, 52, 79, 52, 52, 52, 52, 34, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 54, 54, 54, 54, 54, 48, 54, 54, 54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 72, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 72, 58, 58, 58, 58, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 61, 59, 59, 59, 103, 103, 61, 103, 61, 61, 59, 59, 59, 59, 59, 59, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 59, 63, 63, 63, 62, 62, 62, 62, 62, 62, 54, 62, 62, 62, 64, 64, 64, 62, 64, 64, 64, 64, 64, 63, 63, 63, 63, 63, 63, 72, 63, 63, 63, 64, 40, 63, 99, 99, 40, 40, 40, 63, 63, 99, 111, 58, 65, 64, 64, 64, 64, 64, 64, 64, 64, 66, 64, 66, 66, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 65, 65, 73, 84, 65, 87, 90, 65, 65, 65, 65, 65, 65, 65, 65, 65, 66, 66, 66, 66, 79, 85, 85, 66, 77, 85, 66, 66, 66, 66, 66, 66, 66, 66, 67, 67, 97, 97, 67, 97, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 31, 31, 31, 102, 31, 31, 31, 102, 102, 77, 69, 69, 69, 77, 68, 68, 68, 68, 31, 68, 68, 68, 77, 77, 68, 68, 98, 69, 98, 74, 74, 74, 74, 92, 98, 74, 92, 65, 69, 74, 74, 74, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 15, 71, 96, 15, 71, 71, 71, 96, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 73, 65, 41, 73, 41, 65, 42, 73, 41, 73, 73, 73, 55, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 43, 46, 46, 43, 43, 74, 69, 64, 74, 74, 74, 74, 75, 75, 75, 75, 75, 63, 75, 63, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 92, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 90, 90, 90, 90, 90, 90, 77, 110, 90, 77, 90, 90, 90, 90, 90, 90, 68, 90, 110, 90, 111, 111, 101, 101, 101, 101, 101, 101, 101, 108, 78, 92, 78, 101, 111, 92, 78, 78, 108, 74, 108, 91, 92, 108, 109, 77, 108, 108, 108, 92, 92, 92, 92, 77, 77, 108, 80, 80, 80, 80, 109, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 81, 81, 81, 81, 48, 81, 82, 105, 64, 81, 22, 22, 81, 81, 81, 81, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 110, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 84, 53, 84, 84, 59, 59, 84, 84, 59, 59, 76, 84, 51, 84, 59, 59, 62, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 109, 86, 86, 86, 86, 86, 86, 86, 84, 69, 86, 86, 106, 84, 86, 86, 87, 98, 87, 86, 87, 91, 98, 87, 91, 98, 86, 91, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 88, 88, 65, 74, 88, 88, 65, 65, 65, 88, 86, 44, 74, 69, 75, 74, 74, 99, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 89, 96, 96, 96, 89, 99, 96, 96, 96, 96, 96, 96, 96, 90, 79, 90, 90, 109, 90, 90, 90, 79, 90, 90, 90, 90, 90, 90, 79, 90, 109, 69, 70, 79, 87, 90, 79, 70, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 92, 92, 92, 91, 92, 92, 92, 92, 74, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 65, 44, 65, 52, 65, 62, 5, 52, 44, 52, 84, 84, 98, 98, 98, 106, 106, 106, 90, 84, 44, 86, 106, 106, 86, 106, 75, 5, 86, 86, 78, 87, 84, 84, 70, 84, 85, 85, 85, 85, 85, 85, 107, 107, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 96, 96, 96, 96, 89, 96, 89, 89, 96, 96, 96, 96, 96, 96, 96, 96, 97, 97, 97, 97, 97, 72, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 33, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 74, 74, 98, 98, 74, 98, 98, 98, 74, 74, 74, 98, 74, 74, 98, 98, 74, 74, 74, 111, 83, 111, 76, 98, 76, 111, 76, 98, 98, 98, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 100, 100, 100, 100, 92, 100, 100, 100, 92, 92, 100, 100, 92, 92, 92, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 100, 100, 100, 100, 100, 101, 100, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 100, 100, 100, 100, 100, 100, 102, 102, 102, 102, 77, 102, 77, 102, 77, 77, 77, 102, 102, 102, 102, 75, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 108, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 75, 93, 75, 93, 93, 75, 75, 75, 75, 75, 104, 104, 104, 104, 104, 104, 104, 104, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 85, 85, 106, 106, 81, 106, 8, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 107, 107, 17, 97, 17, 17, 79, 79, 17, 17, 107, 107, 107, 96, 107, 96, 96, 96, 107, 107, 108, 108, 108, 77, 108, 84, 108, 84, 108, 108, 103, 103, 103, 108, 103, 103, 108, 108, 79, 103, 79, 103, 79, 79, 79, 103, 79, 79, 79, 79, 103, 103, 79, 87, 103, 103, 79, 103, 79, 103, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 98, 98, 110, 110, 110, 110, 110, 98, 110, 110, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 17, 83, 83, 83, 83, 111, 83, 83, 83, 112, 52, 52, 112, 112, 96, 112, 112, 52, 112, 112, 112, 112, 112, 112, 52, 112, 105, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112]
test_labels = \
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 69, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 102, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 103, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 105, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112, 112]
assert len(test_results) == len(test_labels)
print('种平均准确率为: {:.5f}'.format(np.equal(test_results, test_labels).astype(np.float32).mean()))


# 生成 genus 预测标签列表和真实标签列表
genus_name_list = []
for name in name_list:
    if not name.split(' ')[0] in genus_name_list:
        genus_name_list.append(name.split(' ')[0])
genus_test_results = [name_list[result].split(' ')[0] for result in test_results]
genus_test_labels = [name_list[result].split(' ')[0] for result in test_labels]
print(len(genus_name_list), "genus_name_list:\n", genus_name_list)
# 计算属的平均准确率（期望）
correct_num = 0
for i in range(len(genus_test_labels)):
    if genus_test_results[i] == genus_test_labels[i]:
        correct_num += 1
print('属平均准确率为: {:.5f}'.format(correct_num / len(genus_test_labels)))
# 计算每个属对应的准确率
genus_acc_list = []
for genus_id in range(len(genus_name_list)):
    # 保存当前属的ground truth label的索引
    gt_index_list = []
    for index, genus_number in enumerate(genus_test_labels):
        if genus_number == genus_name_list[genus_id]:
            gt_index_list.append(index)
    genus_acc_num = 0
    for gt_index in gt_index_list:
        if genus_test_results[gt_index] == genus_name_list[genus_id]:
            genus_acc_num += 1
    genus_acc = float(format(genus_acc_num / len(gt_index_list), '.2f'))
    genus_acc_list.append(genus_acc)
# print(len(genus_acc_list), genus_acc_list)
# for i in genus_acc_list:
#     print(i)


# 生成family预测标签列表和真实标签列表
family_name_list = []
for name in name_list:
    if not name_dict[name]["family"] in family_name_list:
        family_name_list.append(name_dict[name]["family"])
print(len(family_name_list), "family_name_list:\n", family_name_list)
family_test_results = [name_dict[name_list[result]]["family"] for result in test_results]
family_test_labels = [name_dict[name_list[result]]["family"] for result in test_labels]
# 计算科的平均准确率（期望）
correct_num = 0
for i in range(len(family_test_labels)):
    if family_test_results[i] == family_test_labels[i]:
        correct_num += 1
print('科平均准确率为: {:.5f}'.format(correct_num / len(family_test_labels)))
# 计算每个科对应的准确率
family_acc_list = []
for family_id in range(len(family_name_list)):
    # 保存当前属的ground truth label的索引
    gt_index_list = []
    for index, family_number in enumerate(family_test_labels):
        if family_number == family_name_list[family_id]:
            gt_index_list.append(index)
    family_acc_num = 0
    for gt_index in gt_index_list:
        if family_test_results[gt_index] == family_name_list[family_id]:
            family_acc_num += 1
    family_acc = float(format(family_acc_num / len(gt_index_list), '.2f'))
    family_acc_list.append(family_acc)
print(len(family_acc_list), family_acc_list)
for i in family_acc_list:
    print(i)
